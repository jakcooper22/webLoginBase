<!DOCTYPE html>

<html> 
<body>
  <p> Going to create a basic login form </p>
	<form action="/users" method="POST">
		<input type="text" id="uname" name="uname"><br>
		<input type="text" id="pword" name="pword"><br>
		<input type="submit" value="Submit">
	</form>

	<p> Above is a version for a login </p>

	<div id="login">
		<p>User <input type="text" id="username"></p>
		<p>Email <input type="text" id="email"></p>
		<p>Password <input type="password" id="password"></p>
		<button onclick="loginUser()">Log In</button>
	</div>

	<script src="https://unpkg.com/react@17/umd/react.development.js" crossorigin></script>
	<script src="https://unpkg.com/react-dom@17/umd/react-dom.development.js" crossorigin></script>

	<!-- Load our React component. 
	<script src="javascripts/submit_button.js"></script> -->

	<script>	
		function loginUser() {
      var uname = document.getElementById("username").value;	
			var pword = document.getElementById("password").value;
			var email = document.getElementById("email").value;

			var xhttp = new XMLHttpRequest();
			xhttp.onreadystatechange = function () {
				if (this.readyState == 4 && this.status == 200) {
					const token = JSON.parse(this.responseText);
					window.localStorage.setItem("token", token.token);
					var storageToken = localStorage.getItem("token");
					verifyToken(storageToken);
				};
			};
			xhttp.open("POST", "/users", true);
			xhttp.setRequestHeader("Content-type", "application/x-www-form-urlencoded");
			xhttp.send("uname=" + uname + "&pword=" + pword + "&email=" + email);
		}

		function verifyToken(token) {
			console.log(token);
			var xhttp = new XMLHttpRequest();
			xhttp.onreadystatechange = function () {
				if (this.readyState == 4 && this.status == 200) {
					
				};
			};
			xhttp.open("POST", "/users/tokenPage", true);
			xhttp.setRequestHeader("Content-type", "application/x-www-form-urlencoded");
			xhttp.send("token=" + token);
		};
	</script>
</body>
</html>
